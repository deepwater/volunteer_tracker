.page-header
  - if can? :manage, :all
    .pull-right.switcher
      .quick-jump
        ' Quick Jump:
        .inline-block = select_tag("department_block_department_chooser", options_from_collection_for_select(Department.order("name"), "id", "name", @department.id), :class => "span3")
  h1 Department: #{@department.name}

.col-sm-4
  .progress
    .bar class=(get_department_usage_class(@department.estimate_hours_total, @department.budgeted_hours)) style="width: #{get_department_usage(@department.estimate_hours_total, @department.budgeted_hours)}%;"
  h4 Budgeted Hours Progress
  p
    strong Estimated Hours: 
    =@department.estimate_hours_total.to_i
  p
    strong Budgeted Hours: 
    =@department.budgeted_hours.to_i
.col-sm-4
  .progress
    .bar class=(get_department_usage_class(@department.scheduled_count, @department.total_slots)) style="width: #{get_department_usage(@department.scheduled_count, @department.total_slots)}%;"
  h4 Block Scheduling Progress
  p
    strong Scheduled Slots: 
    =@department.scheduled_count
  p
    strong Total Slots: 
    =@department.total_slots
.col-sm-4
  .progress
    .bar
  h4 Volunteer Hours Progress
  p
    strong Hours: 
    = @volunteer_hours[@department.id].to_i

.separate-block

.col-sm-12
  ul.nav.nav-tabs
    - @days.each_with_index do |day, index|
      li class=(index == 0 ? "active" : "")
        = link_to "##{day.safe_short_date}", :'data-toggle' => 'tab' do
          = day.day_name
          = day.short_date

  .tab-content
    - @days.each_with_index do |day, index|
      div id="#{day.safe_short_date}" class=(index == 0 ? "active tab-pane" : "tab-pane")

javascript:

  window.initDepartmentsShowPage = function() {
    var firstHash, reloadSchedule;
    reloadSchedule = function(dateid) {
      return $.ajax("" + window.location.pathname + "/schedule/2014/" + dateid.slice(0, 2) + "/" + dateid.slice(2), {
        type: 'GET',
        dataType: 'html',
        error: function(jqXHR, textStatus, errorThrown) {
          return $("div[id=" + dateid + "]").text("Error: " + textStatus);
        },
        success: function(data, textStatus, jqXHR) {
          $("div[id=" + dateid + "]").html(data);
          $("table[id=blocks" + dateid + "]").dataTable({"iDisplayLength": 100, "aLengthMenu": [[100, 200, -1], [100, 200, "All"]]});
          $('.timepicker').timepicker();
          $('.delete-department-block').on('click', function() {
            return setTimeout(function() {
              return window.location.reload();
            }, 200);
          });
          return $('.create_department_block').on('click', function() {
            var $el, modal;
            modal = $(this).attr('href');
            $el = $(modal + " #department_block_name");
            return setTimeout(function() {
              return $el.focus();
            }, 300);
          });
        }
      });
    };
    $('#department_block_department_chooser').change(function() {
      var newVal;
      newVal = $(this).val();
      return window.location = "/dashboard/departments/" + newVal;
    });
    firstHash = $('li.active a').attr('href');
    $(firstHash + ' #day_hash:hidden').val(firstHash.replace('#', ''));
    if (window.location.hash) {
      $('a[href="' + window.location.hash + '"]').click();
    }
    $('.nav.nav-tabs a').click(function() {
      var hash;
      window.location.hash = $(this).attr('href');
      reloadSchedule(window.location.hash.replace('#', ''));
      hash = $(this).attr('href');
      return $(hash + ' #day_hash:hidden').val(hash.replace('#', ''));
    });
    return reloadSchedule($('li.active a').attr('href').replace('#', ''));
  };

  $(function() {
    window.initDepartmentsShowPage();
  })